#  絵でわかるサイバーセキュリティ
## 1. セキュリティとリスク
### 1-1. 情報セキュリティの3要素（6要素）<br>
情報セキュリティ JIS Q 27000(ISO 27000)<br>
「情報の機密性、完全性及び可用性を維持すること」

1. 機密性(Confidentiality)：情報資産へのアクセス制御ができていること
2. 完全性(Integrity)：情報資産が正確で完全であること
3. 可用性(Availability)：情報資産を使いたい時に使えること
4. 責任追跡性：システムや利用者の行動が記録され、後から確認できること
5. 真正性：システムも利用者も「なりすまし」が起っていないこと
6. 信頼性：システムが矛盾なく動作すること

### 1-2. リスクの要素
1. 情報資産：何が資産かを明確化しておかないと守れない
2. 脅威：情報資産に損害を与えたり、脅かしたりする要素
    - 物理的脅威：火災、地震、落雷など自然災害、侵入者による破壊など
    - 技術的脅威：コンピュータウイルス、不正アクセス、ソフトウェアバグなど
    - 人的脅威  ：操作ミス、内部犯による情報漏洩など
3. 脆弱性：脅威につけ込まれそうな自らの弱点
    - 物理的脆弱性：耐震耐火構造の不備、入退室管理の不備など
    - 技術的脆弱性：アクセス制御の不備、セキュリティホールの放置など
    - 人的脆弱性：セキュリティ教育の不備、規定の不備など

3つの要素が揃っている => 「リスクが顕在化している」<br>
要素を減らす対策が必要 => 1と2は減らすのが困難<br>
「セキュリティ対策」＝「脆弱性をなくしていくこと」

### 1-3. リスクマネジメント
1. セキュリティマネジメントシステム<br>
リスクコントロールを明文化した文書を作成し、実行組織で運用する。<br>
運用は「PDCAサイクル」を繰り返すのが基本
2. リスクアセスメントと受容基準<br>
リスク特定 => リスク分析 => リスク評価
    - リスク特定：リスクのリストアップ
    - リスク分析：リスクの発生頻度×影響度
    - リスク評価：受容水準＝リスクを受け入れるレベルを決定
3. リスク対応<br>
受容水準を超えたリスクの低減を行う
    - リスク保有：リスクをそのまま持ち続ける（費用対効果）
    - リスク移転：リスクを肩代わり（保険）
    - リスク低減：工夫によりリスクを小さくする（セキュリティ対策の大半）
    - リスク回避：リスクをなくしてしまう。副作用も大きい。

### 1-4. セキュリティの歴史
- 最小権限の原則
- 暗号化
- ペリメータライン（境界線）の作成

=> 情報セキュリティでは、境界線が目に見えない、守る箇所が増えている

- ゼロトラスト：信頼ゼロ => ネットワークに信頼できる場所はないという考え方

### 1-5. IoT時代のセキュリティ
- 24時間365日稼働時代
- 利用者のリテラシ：最も有効なセキュリティ対策はセキュリティ教育

## 2. サイバーセキュリティーの基礎
### 2-1. アクセスコントロール
1. 認識：利用者IDなど
2. 認証：パスワードなど
3. 認可：アクセス権の設定など

### 2-2. パスワードという欠陥品

- 推測されやすい：忘れないため自分に関係ある情報で設定しがち
- 運用で回避：長く複雑、定期更新、個人情報によらない、サービス毎に変える<br>
=> 利用者に負担を強いる：メモしたり使い回ししたりでリスクが増える矛盾

- パスワードへの攻撃
  - 総当たり攻撃（ブルートフォースアタック）
  - 逆総当たり攻撃（リバースブルートフォースアタック）
- 認証機構のいま
  - バイオメトリクス：指紋、顔など
  - 二要素認証：パスワード＋SMSなど
  - リスクベース認証：普段の端末はPW、その他の場合は追加認証

### 2-3. 暗号
#### 2-3-1. 共通鍵暗号
- 暗号アルゴリズム：アルファベットのシフト（方法）
- 鍵：シフト量

#### 2-3-2. 公開鍵暗号
- 公開鍵暗号：暗号化鍵と復号鍵
- 暗号化鍵  ：暗号を作ることしかできない（公開可能：公開鍵）
- 復号鍵    ：復号できる鍵（大事：秘密鍵）

#### 2-3-3. ハッシュ
1. ハッシュ値の特徴（ハッシュ関数での変換）
    - データによらず、一定の長さのハッシュ値になる
    - 異なるデータから同じハッシュ値が出現する確率はとても低い
    - ハッシュ値から元のデータは復元できない（不可逆的）
    - 同じデータからは同じハッシュ値が生成される
    - 元のデータが異なると全く違うハッシュ値が出てくる
2. ハッシュ関数の用途
    - DBへのパスワード値の補完
    - プログラムの改ざんチェック
    - メール、文書の改ざんチェック
3. ハッシュの寿命
    - 変換表が作成される
    - 異なるデータから同じハッシュ値を出力される「衝突」のテクニック
    - MD5は衝突のさせ方が広まり危殆化している

#### 2-3-4. PKI（デジタル証明書） 
1. デジタル署名<br>
送信者が暗号化鍵と復号鍵のペアを作成 => 復号鍵を公開<br>
作成者が誰かを証明できる
2. デジタル証明書とPKI<br>
偽物のデジタルを見分けるための仕組み
    - 公開鍵と身分証 => 認証局（CA）に送る
    - 認証局：公正な第三者機関
    - 身分を確認し、公開鍵に有効期限を付加し、認証局の秘密鍵で書名
    - 以上によって作成されたものが「デジタル証明書」となる 
    - 認証局の公開鍵 => 送信者の公開鍵を取り出す
    - サーバでも同様の仕組みが採用（サーバ証明書）
    - 認証局の公開鍵はブラウザに組み込まれている

## 3. サイバー攻撃の方法
### 3-1. ソーシャルエンジニアリング（社会工学的手法）
人間の錯覚や心理的間隙につけこむ手口
- ショルダーハッキング：ATMで暗証番号を盗み見る
- スキャベジング：ゴミ箱あさり（情報入手）
- なりすまし

### 3-2. マルウェア
悪意ある動作、利用者が意図しない動作をするソフトウェアの総称
- コンピュータウィルス：アプリケーションに寄生して動作
- ワーム：寄生先なしに動作
- マルウェアの定義
  - 自己伝染能力
  - 潜伏機能
  - 発病機能
    - コックローチウィルス
    - ボット
    - ランサムウェア
- 感染経路
  - メール添付ファイル
  - USBメモリ など

### 3-3. 脆弱性につけ込む攻撃
- ポートスキャン：開いているポートを調べる（攻撃準備）
- バッファオーバーフロー
  - バッファ以上のデータを送り、動作不能に陥らせる
  - バッファの構造を理解し、違う動作をさせる

### 3-4. 負荷をかける攻撃
- DoS攻撃（サービス妨害攻撃）：攻撃者から大量の通信が送られてくる
- DDoS攻撃（分散型DoS攻撃）：大量の踏み台から通信が送られてくる
- 実際の攻撃手法
  - Ping Flood攻撃：pingツールの悪用 => ping機能の制限：利便性低下
  - TCP SYN Flood攻撃：3ウェイハンドシェイクの途中で止め、ポートを枯渇

### 3-5. 標的型攻撃
準備期間を十分に取り、攻撃対象への理解を深めた上での攻撃<br>
- 水飲み場型攻撃：標的型攻撃の変種：対象者がよく使用するWebサイトを改ざんして攻撃
- サプライチェーン攻撃：攻撃対象を本社→系列会社、取引先企業へ

### 3-6. その他攻撃
- セッションハイジャック：一連の通信を乗っ取り<br>
cookie、URL埋め込み、hiddenフィールドへの埋め込みで共有するセッションID、シーケンス番号を入手 => 乗っ取り<br>
対策：IDの複雑化、ポート番号のランダム化
- セッションフィクセーション：攻撃者自身が作成したセッションIDをサーバに送り、認めさせる
- DNSキャッシュポイズニング(1)<br>
DNSキャッシュサーバにIPアドレスを問い合わせ<br>
=> 正しいアドレスが届く前に嘘のIPアドレスを送り、おぼえさせる<br>
=> 別サイトへ誘導
- DNSキャッシュポイズニング(2)<br>
DNSキャッシュサーバにIPアドレスを問い合わせ（大量の付帯情報）<br>
=> 返信も大量のデータとなる<br>
=> 返信先は攻撃者がなりすました攻撃ターゲット<br>
=> 身に覚えのない大量のDNSが突然送られる
    - DNSSEC<br>
    DNSにセキュリティ機能を持たせたDNSキャッシュポイズニング対策の本命だが、普及には時間がかかりそう。
- XSS（クロス・サイト・スクリプティング）<br>
Webフォーム、掲示板に悪意あるスクリプトを追加する<br>
以前は他のサイトに飛ぶパターンが多かった => XSS<br>
現在はサイトを移動させない手法が主流

## 4. セキュリティ対策の方法
### 4-1. 攻撃を検出する
#### 4-1-1. 不正アクセスを防ぐ構造
- サーバへの認証システムを組み込む（当たり前だが大事）<br>
不正アクセス禁止法：アクセス制限機能を有するコンピュータが対象<br>
- Webサーバ、メールサーバ、DNSサーバと一般的サーバを分ける

### 4-2. 不正アクセスの検知
#### 4-2-1. IDS／IPS
- IDS(Instrusion Detection System)：侵入検知システム（アラートのみ）
  - ホスト型IDS：インストール型
  - ネットワーク型IDS：パケットを取得して検査
- IPS(Instrusion Prevension System)：侵入防止システム（アラート＋切断）

### 4-3. ネットワークからの攻撃に耐える
#### 4-3-1. ファイアウォール
ネットワークの境界線上に設置し、通過させる通信と通過させない通信を餞別<br>
OSI参照モデルの第3層、第4層で識別
- IPアドレス：コンピュータ単位
- ポート番号：ソフトウェア単位

#### 4-3-2. WAF、ゲートウェイ
- ゲートウェイ<br>
OSI参照モデルの第7層（アプリケーション）を用いて制御する通信機器
- WAF(Web Application Firewall)<br>
Webサーバに特化した通信機器

#### 4-3-3. プロキシサーバ
プロキシサーバ：代理サーバ
- 通信の効率アップ
- セキュリティの向上：第三者に余計な情報を与えない

#### 4-3-4. シングルサインオン
面倒なログイン手続きを一括処理する方法
- リバースプロキシ：同一会社のサービスを単一ログインで利用
- パスワード管理サービス：過度な信用は危険
- GAFAなどのID／PWを利用

### 4-4. 公共の場所を安全に使う
#### 4-4-1. VPN(Virtual Private Network：仮想専用線)
- トランスポートモード：全暗号化、ソフト必須
- トンネルモード：拠点間接続、VPN装置必須

#### 4-4-2. SQLインジェクションとプレースホルダ
- SQLインジェクション<br>
SQL構文を変えてしまう入力で攻撃
- プレースホルダ<br>
先に構文を解釈し、入力データを空きに当てはめる

### 4-5. システムとデータを守る
#### 4-5-1. バックアップと世代管理
- バックアップ：データ喪失のリスク低減にバックアップは必須
- 世代管理：戻したい状態に合わせ任意の時に戻す
- リストア：復旧
- バックアップしていても正常に行われておらず、リストアできないなどのケースもあり

1. フルバックアップ：毎回、対象データを全てバックアップ
2. 差分バックアップ：基準時にフルバックアップ、その後は変更分の加算
3. 増分バックアップ：基準時にフルバックアップ、その後は変更文のみ
4. ジャーナル（操作記録）：バックアップ間の記録を残し、細かい復元に対応

## 5. サイバーセキュリティの法規と制度
### 5-1. セキュリティ関連の法律
#### 5-1-1. サイバーセキュリティ基本法
陸、海、空、宇宙に続く第5の空間がサイバースペース<br>
=> サイバーセキュリティ基本法
- サイバーセキュリティ戦略の基本原則
  1. 情報の自由流通の確保
  2. 法の支配
  3. 開放性
  4. 自律性
  5. 多様な主体の連携
- サイバーセキュリティ戦略本部の設置 => 省庁、自治体などは責務を負う

#### 5-1-2. 個人情報保護法
- 個人情報を取り扱う全ての事業者：安全かつ適正に扱う
- 個人情報：生きている個人に関する情報
  - 氏名や電話番号で「それが誰の情報か」を特定できる情報
  - 普段読んでいる本のリスト＋利用者番号 ＝ 個人情報
- 要配慮個人情報<br>
人種、信条、社会的身分、病歴、犯罪歴、犯罪被害歴、障害の有無など、不当な差別や偏見につながりかねない情報

#### 5-1-3. プライバシーマーク
プライバシーマークの取得：高度な個人情報保護体制を確立<br>
JIS Q 15001「個人情報保護マネジメントシステムの要求事項」

### 5-2. 知的財産権(IP：Intellectual Prpperty)
- 知的財産権
  - 著作権
  - 産業的財産権
    - 特許権
    - 実用新案権
    - 意匠権
    - 商標権

#### 5-2-1. 著作権
小説、絵画、音楽など著作物に関する権利
- 著作権：著作物をつくったときに自然発生
  - 著作者人格権：譲渡不可
    - 公表権
    - 氏名表示権
    - 同一性保持権
  - 著作財産権：売買可能
    - 複製権
    - 公衆送信権
    - 送信可能化権
- 著作権なし：アイデア、ノウハウ、、創造性のない表現、自然科学上の知見、開発言語、アルゴリズム、データ
- 著作権あり：プログラム、データベース
- 業務で作成：会社に著作権が帰属
- 利用推進策
  - 自由利用マーク（文化庁）
  - クリエイティブ・コモンズ・ライセンス
  - 同人マーク：二次創作

#### 5-2-2. 産業的財産権
- 特許権<br>
自然法則を利用した技術的思想の創作うち、高度のものに与えられる権利<br>
先願主義
- 実用新案権<br>
自然法則を利用した技術的思想の創作に与えられる権利
- 意匠権<br>
工芸品や工業品のデザインに対して与えられる権利
- 商標権<br>
商品やサービスに付与する、いわゆるトレードマークの権利を保護するもの

## 6. セキュリティポリシーとマネジメントシステム
### 6-1. 情報セキュリティポリシー
#### 6-1-1. 情報セキュリティポリシーと3つの文書
1. 情報セキュリティ基本方針
2. 情報セキュリティ対策基準
3. 情報セキュリティ実施手順（情報セキュリティプロシージャ（マニュアル））
- 作り方とポイント
  - 雛形（ISO/IEC 27002）を元につくる：ベースラインアプローチ
- 死文化に注意
  - シャドーITなどセキュリティ水準が低下

#### 6-1-2. 情報セキュリティマネジメントシステム
- ポリシーの実現機構
- PDCAサイクルで運用
- 経営層の参加

#### 6-1-3. マネジメントシステムの運用とフォロー
- CSIRT(Computer Security Incident Response Team)<br>
日々のセキュリティ活動を行うチーム
- 監査とフォローアップ
  - 監査の独立性と客観性の確保
  - 監査人の知識、技能、経験も必要
  - フォローアップによる改善の確認も重要

## 7. セキュリティ事故が起ったら
### 7-1. セキュリティ事故対応のフェーズ
#### 7-1-1. 初動処理の大切さ
- 「事故は起きるもの」と想定しておく
- 禁忌のようにすると隠す可能性がある
- 不適切な行為を必要以上に責めない制度設計も必要

#### 7-1-2. 初動処理と問題解決
1. 応急処置をして事態の悪化を防ぐ
2. 速やかに根本原因の究明と解決

#### 7-1-3. インシデント遭遇時の初動対応とセキュリティ教育の必要性
- マニュアルを作っておくと良い<br>
情報セキュリティ事故対応ガイドブック（経産省）など
- 窓口(CSIRT)に連絡
- ネットワークを切断する

#### 7-1-4. セキュリティ教育の必要性
- セキュリティ教育
  - 初動対応の迅速化
  - 被害の最小化
  - 内部犯の抑止にも効果あり

#### 7-1-5. 復旧の目標を定める
- RPO(Recovery Point Objective) ：目標復旧時点
- RTO(Recovery Time Objective)  ：目標復旧時間

### 7-2. インシデント発生時に業務を止めないためには
#### 7-2-1. フォールトアボイダンスとフォールトトレランス
- フォールトアボイダンス：回避<br>
高信頼性なデバイス（高価）を導入など
- フォールトトレランス：寛容<br>
冗長化して信頼性を上げる（低コスト）
  - デュアルシステム：無駄が多い
  - デュプレックスシステム：無駄が少ない

#### 7-2-2. フェール××
- フェールセーフ（安全側故障）：安全側に故障する
- フェールソフト（軟着陸故障）：縮退運転、一部を止めて他を救う

#### 7-2-3. フールプルーフ
- フールプルーフ：「間違った使い方への耐性」
  - ポップアップ等「本当に○○しますか？」
  - ゴミ箱のしくみ など